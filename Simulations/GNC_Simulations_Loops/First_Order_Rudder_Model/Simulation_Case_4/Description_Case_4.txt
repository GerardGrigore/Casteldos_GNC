Composition of the 'Simulation_Case_4' closed loop simulation:

- A Guidance algorithm that computes, at a Guidance frequency, an aimed heading
  angle. This is done thanks to the Navigation estimates of current positions and
  current heading. The generation of the heading profile is sensitive to the
  quality of the estimated data as well as the frequency of the Guidance function
  itself.

- A Control section exploiting the use of a discretized PIDF controller, coupled
  with a saturation of the commanded rudder angle. A coupling seems to be done in between
  the boundary values of the saturation and the frequency of "actions" of Control and
  Guidance. If the boundaries are stringent and the frequency high, the action might not
  be enough to guarantee the Control. In that case, anti wind-up compensation might be 
  of interest.
  After the implementation of the Anti Wind-Up algorithm, the performance have significantly
  increased. Indeed, event with stringent constraint on the bounds of the command and with
  a very high frequency of Guidance function calling, the output does not diverge. Better,
  The oscillations of the heading are of very low amplitude and the route is perfecly well
  followed.

- The wave discretized transfer function perturbing the heading angle generated by the 
  low frequency controller.

- Navigation estimation: a first block of sensor fusion. This blocks simulates three kind of
  sensors: compass (magnetometer), GPS and an IMU. Prior to this, a block kinematics uses
  the heading to retreive the positions simulated by the sensors. In the output of the 
  sensors block, a sensor fusion algorithm in the form of an Extended Kalman Filter 
  (non-linear KF) is used to provide a single fused heading value and the positions 
  along the X-Axis (East) and Y-Axis (North). Then, the second high-level estimation block
  is a Kalman Filter/Observer estimator of the wave induced heading.
  The output of the block Navigation is therefore a fused and filtered heading and filtered
  positions.

- Anti Wind-Up compensation algorithm based on the Anti Wind-Up control theory:
  https://techteach.no/fag/sesm3401/h08/pid_diskret/tidsdiskret_pid_reg.pdf
  https://techteach.no/fag/sesm3401/h08/pid_diskret/tidsdiskret_pid_reg.pdf
  https://laas.hal.science/hal-03070178v1/document

Neglected elements:

- ARMA Identification model for the wave features (pulsation & damping).
- Wind perturbation and wind estimator.
- No actuator model.
- Seems to not be robust to the frequency variation of the Navigation block.

The goal here was to add 2 DoF and test a complete loop containing the Guidance algorithm,
the two estimation algorithms and the discretized PIDF controller.

Conclusions:
------------

The main conclusion lies in the frequencies. It is interesting to see that using the 
same frequency of sampling (1/Time_Period_Sampling ~ 1/0.1 = 10 Hz) for all the blocks
and algorithms will lead to a divergence of the system. On the other hand, by increasing a lot
the sampling time of the Guidance algorithm (for example, using a sampling time of 4 seconds
resulting in a frequency of 0.25 Hz), the Guidance generates realistic heading profiles.
Additionally, the saturation does not imply, with such Guidance frequency, a divergence.
Eventually, the wave estimator performs very well, and the heading seems to be well controlled 
and to behave healthily.

However, the implementation of an Anti-wind-Up algorithm helps at allowing to define
cleaner rudder angle profiles. Therefore, it was then possible to increase the Guidance
sampling time up to 20 seconds, having the effect of producing a very nice and clean Heading 
Guidance profile.









 







